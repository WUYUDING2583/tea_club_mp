<!--pages/cart/index.wxml-->
<scroll-view>
  <cu-custom bgColor="bg-gradual-blue" isBack="{{true}}">
    <view slot="backText">返回</view>
    <view slot="content">购物车</view>
  </cu-custom>

  <view class="cu-bar bg-white solid-bottom">
    <view class='action'>
      <text class='cuIcon-titles text-orange '></text> 共{{cartTotal}}件商品
    </view>
    <view class='action'>
      <button class="cu-btn {{isManagement?'bg-green':'bg-blue'}} shadow" style="width:20vw;" bindtap="manage">{{isManagement?"完成":"管理"}}</button>
    </view>
  </view>

  <view wx:if="{{cartTotal==0}}" class="text-grey text-xl flex align-center justify-center" style="width:100vw;height:70vh;">
    <text>空空如也...</text>
  </view>
  <view wx:else>
    <view class="cu-card article" wx:for="{{cartProducts}}" wx:key="unique">
      <view class="cu-item shadow">
        <view class="title">
          <view class="text-cut">{{byCartProducts[item].product.name}}</view>
        </view>
        <view class="content">
          <image src="{{byCartProducts[item].photo}}" mode="aspectFill"></image>
          <view class="desc">
            <view class="text-content">
              <view class="text-red margin-bottom">
                <text wx:if="{{byCartProducts[item].product.price.ingot>0}}">{{byCartProducts[item].product.price.ingot*byCartProducts[item].number}}元宝</text>
                <text wx:if="{{byCartProducts[item].product.price.credit>0}}">{{byCartProducts[item].product.price.credit*byCartProducts[item].number}}积分</text>
              </view>
              <cu-stepper min="1" bindchange="numberChange" option="{{item}}" number="{{byCartProducts[item].number}}"></cu-stepper>
            </view>
            <view class="flex justify-end">
              <view class="margin-right {{!byCartProducts[item].checked?'':'bg-green'}}" style="width:20px;height:20px;border-radius:20px;{{!byCartProducts[item].checked?'border:1px solid #8799a3;':''}}text-align:center" data-target="{{item}}" bindtap="_check">
                <text wx:if="{{byCartProducts[item].checked}}" class="cuIcon-check" style="margin:0 auto;line-height:20px;"></text>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <view class="cu-bar bg-white tabbar border shop padding " style="position:fixed;bottom:0px;width:100vw; ">
    <view class="flex align-center">
      <view class="margin {{!isSelectAll?'':'bg-green'}}" style="width:20px;height:20px;border-radius:20px;{{!isSelectAll?'border:1px solid #8799a3;':''}}text-align:center;" bindtap="_selectAll">
        <text wx:if="{{isSelectAll}}" class="cuIcon-check" style="margin:0 auto;line-height:20px;"></text>
      </view>
      <view style="height:20px;text-align:center;">
        <text style="margin:0 auto;line-height:20px;">全选</text>
      </view>
    </view>
    <view class="action" style="width:50vw;" wx:if="{{!isManagement}}">
      合计:
      <text class="text-red text-lg margin-right " wx:if="{{ingot>0}}">{{ingot}}元宝</text>
      <text class="text-red text-lg margin-right " wx:if="{{credit>0}}">{{credit}}积分</text>
      <text class="text-red text-lg margin-right " wx:if="{{credit==0&&ingot==0}}">0</text>
      <button class="cu-btn bg-blue round shadow-blur " style="width:20vw;" bindtap="_placeOrder">结算</button>
    </view>
    <view class="action" style="width:50vw" wx:else>
      <button class="cu-btn line-blue round shadow-blur " style="width:20vw;" bindtap="_delete">删除</button>
    </view>
  </view>
</scroll-view>